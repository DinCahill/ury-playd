\hypertarget{io__reactor_8hpp_source}{\section{io\+\_\+reactor.\+hpp}
\label{io__reactor_8hpp_source}\index{src/io/io\+\_\+reactor.\+hpp@{src/io/io\+\_\+reactor.\+hpp}}
}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of playd.}
00002 \textcolor{comment}{// playd is licenced under the MIT license: see LICENSE.txt.}
00003 
00010 \textcolor{preprocessor}{#ifndef PS\_IO\_REACTOR\_HPP}
00011 \textcolor{preprocessor}{#define PS\_IO\_REACTOR\_HPP}
00012 
00013 \textcolor{preprocessor}{#include <deque>}
00014 \textcolor{preprocessor}{#include <functional>}
00015 \textcolor{preprocessor}{#include <ostream>}
00016 \textcolor{preprocessor}{#include <set>}
00017 
00018 \textcolor{keyword}{extern} \textcolor{stringliteral}{"C"} \{
00019 \textcolor{preprocessor}{#include <uv.h>}
00020 \}
00021 
00022 \textcolor{preprocessor}{#include "../player/player.hpp"}
00023 \textcolor{preprocessor}{#include "\hyperlink{io__reactor_8hpp}{io\_reactor.hpp}"}
00024 \textcolor{preprocessor}{#include "\hyperlink{io__response_8hpp}{io\_response.hpp}"}
00025 \textcolor{preprocessor}{#include "\hyperlink{tokeniser_8hpp}{tokeniser.hpp}"}
00026 
00027 \textcolor{keyword}{class }\hyperlink{classCommandHandler}{CommandHandler};
00028 \textcolor{keyword}{class }\hyperlink{classPlayer}{Player};
00029 \textcolor{keyword}{class }\hyperlink{classTcpResponseSink}{TcpResponseSink};
00030 
\hypertarget{io__reactor_8hpp_source_l00035}{}\hyperlink{classIoReactor}{00035} \textcolor{keyword}{class }\hyperlink{classIoReactor}{IoReactor} : \textcolor{keyword}{public} \hyperlink{classResponseSink}{ResponseSink} \{
00036 \textcolor{keyword}{public}:
00045     \textcolor{keyword}{explicit} \hyperlink{classIoReactor_aace954427c447c73caf6b8dbcd367284}{IoReactor}(\hyperlink{classPlayer}{Player} &\hyperlink{classIoReactor_a795397b36da55b59bff63b455a344dea}{player}, \hyperlink{classCommandHandler}{CommandHandler} &
      \hyperlink{classIoReactor_a81bf838edb7adf1edcb992bfe61d6b78}{handler},
00046                        \textcolor{keyword}{const} std::string &address, \textcolor{keyword}{const} std::string &port);
00047 
00049     \hyperlink{classIoReactor_aace954427c447c73caf6b8dbcd367284}{IoReactor}(\textcolor{keyword}{const} \hyperlink{classIoReactor}{IoReactor} &) = \textcolor{keyword}{delete};
00050 
00052     \hyperlink{classIoReactor}{IoReactor} &\hyperlink{classIoReactor_a5e05bcbdf86f3124adb67ce76bf4f8a9}{operator=}(\textcolor{keyword}{const} \hyperlink{classIoReactor}{IoReactor} &) = \textcolor{keyword}{delete};
00053 
00058     \textcolor{keywordtype}{void} \hyperlink{classIoReactor_a23f583f9964a6f3f38f983b40f7ae10d}{Run}();
00059 
00065     \textcolor{keywordtype}{void} \hyperlink{classIoReactor_a3566c7200adb102579d2c330a2cbf91d}{End}();
00066 
00081     \textcolor{keywordtype}{void} \hyperlink{classIoReactor_a535c6ff0899391afc02c87b1dfe7c6e2}{NewConnection}(uv\_stream\_t *\hyperlink{classIoReactor_a4c9c61af246fda7db1bdd4e2b3170c66}{server});
00082 
00092     \textcolor{keywordtype}{void} \hyperlink{classIoReactor_af31bb722acf08d10eaa46ea7a1a5d4ca}{RemoveConnection}(\hyperlink{classTcpResponseSink}{TcpResponseSink} &sink);
00093 
00094 \textcolor{keyword}{private}:
\hypertarget{io__reactor_8hpp_source_l00096}{}\hyperlink{classIoReactor_a15617cf44d3c50d5c2d31e8b1812e140}{00096}     std::set<std::shared\_ptr<TcpResponseSink>> \hyperlink{classIoReactor_a15617cf44d3c50d5c2d31e8b1812e140}{connections};
00097 
\hypertarget{io__reactor_8hpp_source_l00099}{}\hyperlink{classIoReactor_a1d8cc56deaa2e801347c21e6490d4f5c}{00099}     \textcolor{keyword}{static} \textcolor{keyword}{const} uint16\_t \hyperlink{classIoReactor_a1d8cc56deaa2e801347c21e6490d4f5c}{PLAYER\_UPDATE\_PERIOD};
00100 
\hypertarget{io__reactor_8hpp_source_l00101}{}\hyperlink{classIoReactor_a4c9c61af246fda7db1bdd4e2b3170c66}{00101}     uv\_tcp\_t \hyperlink{classIoReactor_a4c9c61af246fda7db1bdd4e2b3170c66}{server};    
\hypertarget{io__reactor_8hpp_source_l00102}{}\hyperlink{classIoReactor_a6364acb721e4a7a1374070e317074bbc}{00102}     uv\_timer\_t \hyperlink{classIoReactor_a6364acb721e4a7a1374070e317074bbc}{updater}; 
00103 
\hypertarget{io__reactor_8hpp_source_l00104}{}\hyperlink{classIoReactor_a795397b36da55b59bff63b455a344dea}{00104}     \hyperlink{classPlayer}{Player} &\hyperlink{classIoReactor_a795397b36da55b59bff63b455a344dea}{player};          
\hypertarget{io__reactor_8hpp_source_l00105}{}\hyperlink{classIoReactor_a81bf838edb7adf1edcb992bfe61d6b78}{00105}     \hyperlink{classCommandHandler}{CommandHandler} &\hyperlink{classIoReactor_a81bf838edb7adf1edcb992bfe61d6b78}{handler}; 
00106 
00107     \textcolor{keywordtype}{void} \hyperlink{classIoReactor_a4cfe12db93bda3f7b2c29436c4969006}{RespondRaw}(\textcolor{keyword}{const} std::string &\textcolor{keywordtype}{string}) \textcolor{keyword}{const override};
00108 
00116     \textcolor{keywordtype}{void} \hyperlink{classIoReactor_aab8269bf4512c4c74a56998898b3144e}{InitAcceptor}(\textcolor{keyword}{const} std::string &address, \textcolor{keyword}{const} std::string &port);
00117 
00119     \textcolor{keywordtype}{void} \hyperlink{classIoReactor_a8a586b8e9545e79db8dc9bca3657388f}{DoUpdateTimer}();
00120 \};
00121 
\hypertarget{io__reactor_8hpp_source_l00126}{}\hyperlink{classTcpResponseSink}{00126} \textcolor{keyword}{class }\hyperlink{classTcpResponseSink}{TcpResponseSink} : \textcolor{keyword}{public} \hyperlink{classResponseSink}{ResponseSink} \{
00127 \textcolor{keyword}{public}:
00134     \hyperlink{classTcpResponseSink_aebb4578dd7b9ff9d414c936a27d0969f}{TcpResponseSink}(\hyperlink{classIoReactor}{IoReactor} &\hyperlink{classTcpResponseSink_a190e607290f6ba6b3655c99e44a5e56e}{parent}, uv\_tcp\_t *
      \hyperlink{classTcpResponseSink_afa43e15736053cef76fbf27bdc3197a9}{tcp},
00135                     \hyperlink{classCommandHandler}{CommandHandler} &handler);
00136 
00137     \textcolor{comment}{// Note: This is made public so that the IoReactor can send raw data}
00138     \textcolor{comment}{// to the connection.}
00139     \textcolor{keywordtype}{void} \hyperlink{classTcpResponseSink_a20cbf1820d293f620d6ce030fd5aadc6}{RespondRaw}(\textcolor{keyword}{const} std::string &response) \textcolor{keyword}{const override};
00140 
00148     \textcolor{keywordtype}{void} \hyperlink{classTcpResponseSink_a9ee277599dbd6cfc5853a9145f21694b}{Read}(uv\_stream\_t *stream, ssize\_t nread, \textcolor{keyword}{const} uv\_buf\_t *buf);
00149 
00154     \textcolor{keywordtype}{void} \hyperlink{classTcpResponseSink_a2e40c526177918ade20bec1e4f66698a}{Close}();
00155 
00156 \textcolor{keyword}{private}:
\hypertarget{io__reactor_8hpp_source_l00158}{}\hyperlink{classTcpResponseSink_a190e607290f6ba6b3655c99e44a5e56e}{00158}     \hyperlink{classIoReactor}{IoReactor} &\hyperlink{classTcpResponseSink_a190e607290f6ba6b3655c99e44a5e56e}{parent};
00159 
\hypertarget{io__reactor_8hpp_source_l00161}{}\hyperlink{classTcpResponseSink_afa43e15736053cef76fbf27bdc3197a9}{00161}     uv\_tcp\_t *\hyperlink{classTcpResponseSink_afa43e15736053cef76fbf27bdc3197a9}{tcp};
00162 
\hypertarget{io__reactor_8hpp_source_l00164}{}\hyperlink{classTcpResponseSink_ab289c592752e4c1fdc7d38cc9d6c2aab}{00164}     \hyperlink{classTokeniser}{Tokeniser} \hyperlink{classTcpResponseSink_ab289c592752e4c1fdc7d38cc9d6c2aab}{tokeniser};
00165 \};
00166 
00167 \textcolor{preprocessor}{#endif // PS\_IO\_REACTOR\_HPP}
\end{DoxyCode}
